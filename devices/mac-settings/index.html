<!DOCTYPE html>

<html class="has-navbar-fixed-top">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="generator" content="Hugo 0.70.0" />
  <title>MAC Settings | The Things Stack for LoRaWAN</title><link rel="canonical" href="https://www.thethingsindustries.com/docs/devices/mac-settings/" />
  <link rel="alternate icon" href="/docs/favicon.ico">
  <link rel="alternate icon" type="image/png" href="/docs/favicon.png">
  <link rel="icon" type="image/svg+xml" href="/docs/favicon.svg">
  <link rel="stylesheet" href="https://www.thethingsindustries.com/docs/css/theme.min.87592179d2b736be842bb7a3dd97c7a09f561effecbfb81ec0a18685eb1bd4e0.css" integrity="sha256-h1khedK3Nr6EK7ej3ZfHoJ9WHv/sv7gewKGGhesb1OA=" crossorigin="anonymous">
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta itemprop="name" content="MAC Settings">
  <meta itemprop="description" content="">
  <meta itemprop="keywords" content="">
  <meta property="og:title" content="MAC Settings">
  <meta property="og:description" content="">
  <meta property="og:url" content="https://www.thethingsindustries.com/docs/devices/mac-settings/">
  <meta name="twitter:title" content="MAC Settings" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:card" content="summary" />
</head>


<body>

<nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div id="migration-info">
      <div id="migration-text">thethingsstack.io has moved to thethingsindustries.com/docs</div>
      <div id="migration-button" class="button is-primary">Got it</div>
  </div>
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="/docs/">
        <img class="logo" src="/docs/img/TTS-logo.svg">
        <p class="navbar-item is-size-7">v3.10</p>
      </a>
      <span class="navbar-burger burger" data-target="topMenu">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </div>
    <div id="topMenu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/docs/getting-started/">Getting Started</a>
        <a class="navbar-item" href="/docs/devices/">Devices</a>
        <a class="navbar-item" href="/docs/gateways/">Gateways</a>
        <a class="navbar-item" href="/docs/integrations/">Integrations</a>
        <a class="navbar-item" href="/docs/reference/">Reference</a>
      </div>
      <div class="navbar-end"><div class="navbar-item">
            <a class="button is-primary" href="/docs/download/">Get The Things Stack</a>
          </div>
      </div>
    </div>
  </div>
</nav>


<main>
<section class="section">
  <div class="container">
    <div class="columns">
      
      <div class="column is-one-third">


<h2 class="title is-size-4">MAC Settings</h2>

<ul class="menu-list">
<a href="https://www.thethingsindustries.com/docs/devices/mac-settings/" class="is-active">Overview</a>
</ul>





      </div>
      
      <div class="column is-two-thirds">

<h1 class="title is-size-2">MAC Settings


</h1>

<div class="content">

<p>This section provides guidelines for configuring MAC settings for end devices from the CLI.</p>
<div class="notification is-primary is-light has-text-dark">
  <h3 class="title has-text-dark mb-1">Command-line interface only</h3>
  <p>The instructions below use the command-line interface (CLI).</p>
  <div class="buttons">
    <a class="button is-dark is-outlined" href="https://www.thethingsindustries.com/docs/getting-started/cli/installing-cli/">Learn how to install the CLI</a>
  </div>
</div>

<h3 id="mac-settings-and-mac-state">MAC Settings and MAC State</h3>
<p>MAC settings on The Things Stack are configurable per end device. To configure persistent MAC settings, make changes to <code>mac-settings.desired_&lt;parameter&gt;</code>. Updates to <code>mac-settings.desired_&lt;parameter&gt;</code> take effect on device creation, after OTAA join or ABP FCnt reset, ResetInd, or after MAC state reset.</p>
<p><code>mac-settings.&lt;parameter&gt;</code> represents what the Network Server believes is configured on the end device, and should not be changed, unless the device does not conform to spec. It may however be necessary to set <code>mac-settings.RX1_delay</code> for ABP devices where this is not configured as part of activation.</p>
<p><code>mac-state</code> can be used to test MAC settings in the current session. To update settings for testing in the current session, make changes to the <code>mac-state.desired_parameters.&lt;parameter&gt;</code>. Updates to the <code>mac-state.desired_parameters.&lt;parameter&gt;</code> are applied on the next uplink, and lost on reset.</p>
<p>The expected procedure for testing and updating settings is:</p>
<ol>
<li>Modify <code>mac-state.desired_parameters.&lt;parameter&gt;</code> to see changes in the current session</li>
<li>Test that everything works as expected</li>
<li>Modify <code>mac-settings.desired_&lt;parameter&gt;</code> to make the change permanent</li>
</ol>
<p>If no settings are provided on device creation or unset, defaults are first taken from the device Frequency Plan if available, and finally from <a href="https://www.thethingsindustries.com/docs/reference/configuration/network-server/">Network Server Configuration</a>.</p>
<h3 id="available-mac-settings">Available MAC settings</h3>
<p>Run the following command to get a list of all available MAC settings and available parameter values:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ ttn-lw-cli end-devices <span class="nb">set</span> --help
</code></pre></div><p>You can also refer to the <a href="https://www.thethingsindustries.com/docs/reference/api/end_device/#message:MACSettings">End Device API Reference page</a> for documentation on the available MAC settings and MAC state parameters.</p>
<h3 id="class-specific-settings">Class Specific Settings</h3>
<p>Settings that are useful based on device class are:</p>
<p>All devices:</p>
<ul>
<li><code>mac-settings.factory-preset-frequencies</code></li>
</ul>
<p>Class A:</p>
<ul>
<li><code>mac-settings.desired-rx1-delay</code></li>
<li><code>mac-settings.desired-rx1-data-rate-offset</code></li>
<li><code>mac-settings.desired-rx2-data-rate-index</code></li>
<li><code>mac-settings.desired-rx2-frequency</code></li>
<li><code>mac-settings.supports-32-bit-f-cnt</code></li>
<li><code>mac-settings.use-adr</code></li>
</ul>
<p>Class A ABP:</p>
<ul>
<li><code>mac-settings.resets-f-cnt</code></li>
</ul>
<p>Class B:</p>
<ul>
<li><code>mac-settings.class-b-timeout</code></li>
<li><code>mac-settings.ping-slot-periodicity</code></li>
<li><code>mac-settings.desired-ping-slot-data-rate-index</code></li>
<li><code>mac-settings.desired-ping-slot-frequency</code></li>
</ul>
<p>Class C:</p>
<ul>
<li><code>mac-settings.class-c-timeout</code></li>
</ul>
<p>Some additional examples are included below. All settings are available at the <a href="https://www.thethingsindustries.com/docs/reference/api/end_device/#message:MACSettings">End Device API Reference page</a> and can be viewed using the <code>ttn-lw-cli end-devices set --help</code> command.</p>
<h3 id="configure-factory-preset-frequencies-for-abp-devices">Configure Factory Preset Frequencies for ABP Devices</h3>
<p>To tell The Things Stack which frequencies are configured in an ABP device, set the <code>mac-settings.factory-preset-frequencies</code> parameter. For example, to configure a device using the default EU868 frequencies, use the following command:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ ttn-lw-cli devices update &lt;device_id&gt; --mac-settings.factory-preset-frequencies 868100000,868300000,868500000,867100000,867300000,867500000,867700000,867900000
</code></pre></div><div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  For ABP devices, <code>mac-settings.factory-preset-frequencies</code> should be specified on <code>device create</code> or the settings will only take effect after MAC reset.
</div>
<h3 id="set-duty-cycle">Set Duty Cycle</h3>
<p>To change the duty cycle, set the <code>desired-max-duty-cycle</code> parameter. For example, to set the duty cycle to 0.098%, use the following command:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ ttn-lw-cli end-devices <span class="nb">set</span> &lt;app-id&gt; &lt;device-id&gt; --mac-settings.desired-max-duty-cycle DUTY_CYCLE_1024
</code></pre></div><div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  See the <a href="https://www.thethingsindustries.com/docs/reference/api/end_device/#message:MACSettings">End Device API Reference</a> for available fields and definitions of constants. DUTY_CYCLE_1024 represents 1/1024 â‰ˆ 0.098%.
</div>
<h3 id="enable-adr">Enable ADR</h3>
<p>To enable ADR, set the <code>mac-settings.use-adr</code> parameter</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ ttn-lw-cli end-devices <span class="nb">set</span> &lt;app-id&gt; &lt;device-id&gt; --mac-settings.use-adr <span class="nb">true</span> 
</code></pre></div><h3 id="set-rx1-delay">Set RX1 Delay</h3>
<p>The RX1 delay of end devices is set to 5 second by default. To change it, set the <code>desired-rx1-delay</code> parameter:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ ttn-lw-cli end-devices <span class="nb">set</span> &lt;app-id&gt; &lt;device-id&gt; --mac-settings.desired-rx1-delay RX_DELAY_5
</code></pre></div><h3 id="unset-mac-settings">Unset MAC settings</h3>
<p>The CLI can also be used to unset MAC settings (so that the default ones are used):</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ ttn-lw-cli end-devices <span class="nb">set</span> &lt;app-id&gt; &lt;device-id&gt; --unset mac-settings.rx1-delay
</code></pre></div>
</div>






<div class="is-clearfix">
</div>




      </div>
    </div>
  </div>
</section>
</main>

<footer class="footer background-footer">
  <div class="container">
    <div class="columns">
      <nav class="column is-one-quarter">
        <h3 class="title is-6">The Things Stack</h3>
        <p><a class="" href="/docs/getting-started/">Getting Started</a></p>
        <p><a class="" href="/docs/devices/">Devices</a></p>
        <p><a class="" href="/docs/gateways/">Gateways</a></p>
        <p><a class="" href="/docs/integrations/">Integrations</a></p>
        <p><a class="" href="/docs/reference/">Reference</a></p>
      </nav>
      <nav class="column is-one-quarter">
        <h3 class="title is-6">Contributing</h3>
        <p><a class="" href="https://github.com/TheThingsIndustries/lorawan-stack-docs">GitHub</a></p>
        <p><a class="" href="https://www.thethingsnetwork.org/forum/c/network-and-routing/v3">Forum</a></p>
      </nav>
      
      <nav class="column is-one-quarter">
        <h3 class="title is-6">About Us</h3>
        <p><a class="" href="https://www.thethingsnetwork.org">The Things Network</a></p>
        <p><a class="" href="https://www.thethingsindustries.com">The Things Industries</a></p>
      </nav>
      <div class="column is-one-quarter">
        <h3 class="title is-6">About this page</h3>
        <div class="content">
<p class="is-size-7">
  Last changed by benolayinka on 26 Nov 2020.
  <br>
  <a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/commit/21da11257c965cc9e733dfee24ffc3ac4f2235fd">
      doc: Change info tags to note
    </a>
</p>

<a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/blob/master/doc/content/devices/mac-settings/_index.md" class="button">Edit on Github</a>
</div>

      </div>
    </div>
  </div>
</footer>
<script src="https://www.thethingsindustries.com/docs/js/vendor/basicLightbox.min.js"></script>
<script src="https://www.thethingsindustries.com/docs/js/theme.min.e9df3c06e815b9686686212e86bfd0217a508f5ccee0139d7bc899ef7460191e.js" integrity="sha256-6d88BugVuWhmhiEuhr/QIXpQj1zO4BOde8iZ73RgGR4=" crossorigin="anonymous"></script>

</body>

</html>

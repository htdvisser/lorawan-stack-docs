<!DOCTYPE html>

<html class="has-navbar-fixed-top">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="generator" content="Hugo 0.70.0" />
  <title>Using the API | The Things Stack for LoRaWAN</title><link rel="canonical" href="https://www.thethingsindustries.com/docs/getting-started/api/" />
  <link rel="alternate icon" href="/docs/favicon.ico">
  <link rel="alternate icon" type="image/png" href="/docs/favicon.png">
  <link rel="icon" type="image/svg+xml" href="/docs/favicon.svg">
  <link rel="stylesheet" href="https://www.thethingsindustries.com/docs/css/theme.min.87592179d2b736be842bb7a3dd97c7a09f561effecbfb81ec0a18685eb1bd4e0.css" integrity="sha256-h1khedK3Nr6EK7ej3ZfHoJ9WHv/sv7gewKGGhesb1OA=" crossorigin="anonymous">
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta itemprop="name" content="Using the API">
  <meta itemprop="description" content="">
  <meta itemprop="keywords" content="">
  <meta property="og:title" content="Using the API">
  <meta property="og:description" content="">
  <meta property="og:url" content="https://www.thethingsindustries.com/docs/getting-started/api/">
  <meta name="twitter:title" content="Using the API" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:card" content="summary" />
</head>


<body>

<nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div id="migration-info">
      <div id="migration-text">thethingsstack.io has moved to thethingsindustries.com/docs</div>
      <div id="migration-button" class="button is-primary">Got it</div>
  </div>
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="/docs/">
        <img class="logo" src="/docs/img/TTS-logo.svg">
        <p class="navbar-item is-size-7">v3.10</p>
      </a>
      <span class="navbar-burger burger" data-target="topMenu">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </div>
    <div id="topMenu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/docs/getting-started/">Getting Started</a>
        <a class="navbar-item" href="/docs/devices/">Devices</a>
        <a class="navbar-item" href="/docs/gateways/">Gateways</a>
        <a class="navbar-item" href="/docs/integrations/">Integrations</a>
        <a class="navbar-item" href="/docs/reference/">Reference</a>
      </div>
      <div class="navbar-end"><div class="navbar-item">
            <a class="button is-primary" href="/docs/download/">Get The Things Stack</a>
          </div>
      </div>
    </div>
  </div>
</nav>


<main>
<section class="section">
  <div class="container">
    <div class="columns">
      
      <div class="column is-one-third">


<h2 class="title is-size-4">Using the API</h2>

<ul class="menu-list">
<a href="https://www.thethingsindustries.com/docs/getting-started/api/" class="is-active">Overview</a>
</ul>





      </div>
      
      <div class="column is-two-thirds">

<h1 class="title is-size-2">Using the API


</h1>

<div class="content">

<p>While we recommend using the <a href="https://www.thethingsindustries.com/docs/getting-started/console/">Console</a> or <a href="https://www.thethingsindustries.com/docs/getting-started/cli/">CLI</a> to manage your applications and devices in The Things Stack, we also expose HTTP and gRPC APIs which you can interact directly with. This section contains information about using the HTTP API, and examples.</p>
<p>A complete list of API endpoints is available in the <a href="https://www.thethingsindustries.com/docs/reference/api/">API Reference</a>. There, you can also find detailed information about <a href="https://www.thethingsindustries.com/docs/reference/api/authentication/">Authentication</a> and <a href="https://www.thethingsindustries.com/docs/reference/api/field-mask/">Field Masks</a>.</p>
<blockquote>
<p>If you&rsquo;re having trouble with the HTTP API, you can always inspect requests in the Console using your browser&rsquo;s inspector. All of the data displayed in the Console is pulled using HTTP API requests, and this should give you some insight in to how they are formed.</p>
</blockquote>
<h2 id="http-queries">HTTP Queries</h2>
<p>Additional fields may be specified in HTTP requests by appending them as query string parameters. For example, to request the <code>name</code>, <code>description</code>, and <code>locations</code> of devices in an <code>EndDeviceRegistry.Get</code> request, add these fields to the <code>field_mask</code> field. To get this data for device <code>dev1</code> in application <code>app1</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ curl --location <span class="se">\
</span><span class="se"></span>  --header <span class="s2">&#34;Authorization: Bearer NNSXS.XXXXXXXXX&#34;</span> <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;Accept: application/json&#39;</span> <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;User-Agent: my-integration/my-integration-version&#39;</span> <span class="se">\
</span><span class="se"></span>  <span class="s1">&#39;https://thethings.example.com/api/v3/applications/app1/devices/dev1?field_mask=name,description,locations&#39;</span>
</code></pre></div><p>The same request in tenant <code>tenant1</code> on a multi-tenant deployment:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ curl --location <span class="se">\
</span><span class="se"></span>  --header <span class="s2">&#34;Authorization: Bearer NNSXS.XXXXXXXXX&#34;</span> <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;Accept: application/json&#39;</span> <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;User-Agent: my-integration/my-integration-version&#39;</span> <span class="se">\
</span><span class="se"></span>  <span class="s1">&#39;https://tenant1.thethings.example.com/api/v3/applications/app1/devices/dev1?field_mask=name,description,locations&#39;</span>
</code></pre></div><p>Fields may also be specified as a JSON object in a POST request.</p>
<p>To get a stream of events for device <code>dev1</code> in application <code>app1</code> :</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ curl --location <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;Authorization: Bearer NNSXS.XXXXXXXXX&#39;</span> <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;Accept: text/event-stream&#39;</span> <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;Content-Type: application/json&#39;</span> <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;User-Agent: my-integration/my-integration-version&#39;</span> <span class="se">\
</span><span class="se"></span>  --request POST <span class="se">\
</span><span class="se"></span>  --data-raw <span class="s1">&#39;{
</span><span class="s1">    &#34;identifiers&#34;:[{
</span><span class="s1">        &#34;device_ids&#34;:{
</span><span class="s1">            &#34;device_id&#34;:&#34;dev1&#34;,
</span><span class="s1">            &#34;application_ids&#34;:{&#34;application_id&#34;:&#34;app1&#34;}
</span><span class="s1">        }
</span><span class="s1">    }]
</span><span class="s1">  }&#39;</span> <span class="se">\
</span><span class="se"></span>  <span class="s1">&#39;https://thethings.example.com/api/v3/events&#39;</span>
</code></pre></div><div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  See <a href="https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events/Using_server-sent_events">here</a> for a description of the <code>text/event-stream</code> MIME type.
</div>
<p>If you want to create a device, perform multi step actions, or write shell scripts, it&rsquo;s best to use the <a href="https://www.thethingsindustries.com/docs/getting-started/cli/">CLI</a>.</p>
<p>If you want to do something like registering a device directly via the API, you need to make calls to the Identity Server, Join Server, Network Server and Application Server. See the <a href="https://www.thethingsindustries.com/docs/reference/api/">API Reference</a> for detailed information about which messages go to which endpoints.</p>
<p>To register a device <code>newdev1</code> in application <code>app1</code>, first, register the <code>DevEUI</code>, <code>JoinEUI</code> and cluster addresses in the Identity Server. This is also where you register a friendly name, description, attributes, location, and more - see all fields in the <a href="https://www.thethingsindustries.com/docs/reference/api/">API Reference</a>:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ curl --location <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;Accept: application/json&#39;</span> <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;Authorization: Bearer NNSXS.XXXXXXXXX&#39;</span> <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;Content-Type: application/json&#39;</span> <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;User-Agent: my-integration/my-integration-version&#39;</span> <span class="se">\
</span><span class="se"></span>  --request POST <span class="se">\
</span><span class="se"></span>  --data-raw <span class="s1">&#39;{
</span><span class="s1">    &#34;end_device&#34;: {
</span><span class="s1">      &#34;ids&#34;: {
</span><span class="s1">        &#34;device_id&#34;: &#34;newdev1&#34;,
</span><span class="s1">        &#34;dev_eui&#34;: &#34;XXXXXXXXXXXXXXXX&#34;,
</span><span class="s1">        &#34;join_eui&#34;: &#34;XXXXXXXXXXXXXXXX&#34;
</span><span class="s1">      },
</span><span class="s1">      &#34;join_server_address&#34;: &#34;thethings.example.com&#34;,
</span><span class="s1">      &#34;network_server_address&#34;: &#34;thethings.example.com&#34;,
</span><span class="s1">      &#34;application_server_address&#34;: &#34;thethings.example.com&#34;
</span><span class="s1">    },
</span><span class="s1">    &#34;field_mask&#34;: {
</span><span class="s1">      &#34;paths&#34;: [
</span><span class="s1">        &#34;join_server_address&#34;,
</span><span class="s1">        &#34;network_server_address&#34;,
</span><span class="s1">        &#34;application_server_address&#34;,
</span><span class="s1">        &#34;ids.dev_eui&#34;,
</span><span class="s1">        &#34;ids.join_eui&#34;
</span><span class="s1">      ]
</span><span class="s1">    }
</span><span class="s1">  }&#39;</span> <span class="se">\
</span><span class="se"></span>  <span class="s1">&#39;https://thethings.example.com/api/v3/applications/app1/devices&#39;</span>
</code></pre></div><p>Register LoRaWAN settings in the Network Server:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ curl --location <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;Accept: application/json&#39;</span> <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;Authorization: Bearer NNSXS.XXXXXXXXX&#39;</span> --header <span class="s1">&#39;Content-Type: application/json&#39;</span> <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;User-Agent: my-integration/my-integration-version&#39;</span> <span class="se">\
</span><span class="se"></span>  --request PUT <span class="se">\
</span><span class="se"></span>  --data-raw <span class="s1">&#39;{
</span><span class="s1">    &#34;end_device&#34;: {
</span><span class="s1">      &#34;supports_join&#34;: true,
</span><span class="s1">      &#34;lorawan_version&#34;: &#34;1.0.2&#34;,
</span><span class="s1">      &#34;ids&#34;: {
</span><span class="s1">        &#34;device_id&#34;: &#34;newdev1&#34;,
</span><span class="s1">        &#34;dev_eui&#34;: &#34;XXXXXXXXXXXXXXXX&#34;,
</span><span class="s1">        &#34;join_eui&#34;: &#34;XXXXXXXXXXXXXXXX&#34;
</span><span class="s1">      },
</span><span class="s1">      &#34;lorawan_phy_version&#34;: &#34;1.0.2-b&#34;,
</span><span class="s1">      &#34;frequency_plan_id&#34;: &#34;EU_863_870_TTN&#34;
</span><span class="s1">    },
</span><span class="s1">    &#34;field_mask&#34;: {
</span><span class="s1">      &#34;paths&#34;: [
</span><span class="s1">        &#34;supports_join&#34;,
</span><span class="s1">        &#34;lorawan_version&#34;,
</span><span class="s1">        &#34;ids.device_id&#34;,
</span><span class="s1">        &#34;ids.dev_eui&#34;,
</span><span class="s1">        &#34;ids.join_eui&#34;,
</span><span class="s1">        &#34;lorawan_phy_version&#34;,
</span><span class="s1">        &#34;frequency_plan_id&#34;
</span><span class="s1">      ]
</span><span class="s1">    }
</span><span class="s1">  }&#39;</span> <span class="se">\
</span><span class="se"></span>  <span class="s1">&#39;https://thethings.example.com/api/v3/ns/applications/app1/devices/newdev1&#39;</span>
</code></pre></div><p>Register the <code>DevEUI</code> and <code>JoinEUI</code> in the Application Server:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ curl --location <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;Authorization: Bearer NNSXS.XXXXXXXXX&#39;</span> --header <span class="s1">&#39;Content-Type: application/json&#39;</span> <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;User-Agent: my-integration/my-integration-version&#39;</span> <span class="se">\
</span><span class="se"></span>  --request PUT <span class="se">\
</span><span class="se"></span>  --data-raw <span class="s1">&#39;{
</span><span class="s1">    &#34;end_device&#34;: {
</span><span class="s1">      &#34;ids&#34;: {
</span><span class="s1">        &#34;device_id&#34;: &#34;newdev1&#34;,
</span><span class="s1">        &#34;dev_eui&#34;: &#34;XXXXXXXXXXXXXXXX&#34;,
</span><span class="s1">        &#34;join_eui&#34;: &#34;XXXXXXXXXXXXXXXX&#34;
</span><span class="s1">      }
</span><span class="s1">    },
</span><span class="s1">    &#34;field_mask&#34;: {
</span><span class="s1">      &#34;paths&#34;: [
</span><span class="s1">        &#34;ids.device_id&#34;,
</span><span class="s1">        &#34;ids.dev_eui&#34;,
</span><span class="s1">        &#34;ids.join_eui&#34;
</span><span class="s1">      ]
</span><span class="s1">    }
</span><span class="s1">  }&#39;</span> <span class="se">\
</span><span class="se"></span>  <span class="s1">&#39;https://thethings.example.com/api/v3/as/applications/app1/devices/newdev1&#39;</span>
</code></pre></div><p>Finally, for OTAA devices, register the <code>DevEUI</code>, <code>JoinEUI</code>, cluster addresses, and keys in the Join Server:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ curl --location <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;Authorization: Bearer NNSXS.XXXXXXXXX&#39;</span> --header <span class="s1">&#39;Content-Type: application/json&#39;</span> <span class="se">\
</span><span class="se"></span>  --header <span class="s1">&#39;User-Agent: my-integration/my-integration-version&#39;</span> <span class="se">\
</span><span class="se"></span>  --request PUT <span class="se">\
</span><span class="se"></span>  --data-raw <span class="s1">&#39;{
</span><span class="s1">    &#34;end_device&#34;: {
</span><span class="s1">      &#34;ids&#34;: {
</span><span class="s1">        &#34;device_id&#34;: &#34;newdev1&#34;,
</span><span class="s1">        &#34;dev_eui&#34;: &#34;XXXXXXXXXXXXXXXX&#34;,
</span><span class="s1">        &#34;join_eui&#34;: &#34;XXXXXXXXXXXXXXXX&#34;
</span><span class="s1">      },
</span><span class="s1">      &#34;network_server_address&#34;: &#34;thethings.example.com&#34;,
</span><span class="s1">      &#34;application_server_address&#34;: &#34;thethings.example.com&#34;,
</span><span class="s1">      &#34;root_keys&#34;: {
</span><span class="s1">        &#34;app_key&#34;: {
</span><span class="s1">          &#34;key&#34;: &#34;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&#34;
</span><span class="s1">        }
</span><span class="s1">      }
</span><span class="s1">    },
</span><span class="s1">    &#34;field_mask&#34;: {
</span><span class="s1">      &#34;paths&#34;: [
</span><span class="s1">        &#34;network_server_address&#34;,
</span><span class="s1">        &#34;application_server_address&#34;,
</span><span class="s1">        &#34;ids.device_id&#34;,
</span><span class="s1">        &#34;ids.dev_eui&#34;,
</span><span class="s1">        &#34;ids.join_eui&#34;,
</span><span class="s1">        &#34;root_keys.app_key.key&#34;
</span><span class="s1">      ]
</span><span class="s1">    }
</span><span class="s1">  }&#39;</span> <span class="se">\
</span><span class="se"></span>  <span class="s1">&#39;https://thethings.example.com/api/v3/js/applications/app1/devices/newdev1&#39;</span>
</code></pre></div><h2 id="best-practices">Best Practices</h2>
<h3 id="send-a-user-agent-header">Send a <code>User-Agent</code> Header</h3>
<p>Set the <code>User-Agent</code> HTTP header containing your integration name and version. That way, a network operator can help finding out potential issues using the logs.</p>
<h3 id="respect-x-ratelimit--response-headers">Respect <code>X-Ratelimit-*</code> Response Headers</h3>
<p>The Things Stack sends responses containing information about how many requests your integration has made and how many are remaining, in accordance with the IETF draft spec <a href="https://tools.ietf.org/id/draft-polli-ratelimit-headers-03.html">here</a>.</p>
<h3 id="mind-the-x-warning-headers">Mind the <code>X-Warning</code> Headers</h3>
<p>The Things Stack sends responses containing this header to warn about issues that may become errors in the future.</p>
</div>






<div class="is-clearfix">
</div>




      </div>
    </div>
  </div>
</section>
</main>

<footer class="footer background-footer">
  <div class="container">
    <div class="columns">
      <nav class="column is-one-quarter">
        <h3 class="title is-6">The Things Stack</h3>
        <p><a class="" href="/docs/getting-started/">Getting Started</a></p>
        <p><a class="" href="/docs/devices/">Devices</a></p>
        <p><a class="" href="/docs/gateways/">Gateways</a></p>
        <p><a class="" href="/docs/integrations/">Integrations</a></p>
        <p><a class="" href="/docs/reference/">Reference</a></p>
      </nav>
      <nav class="column is-one-quarter">
        <h3 class="title is-6">Contributing</h3>
        <p><a class="" href="https://github.com/TheThingsIndustries/lorawan-stack-docs">GitHub</a></p>
        <p><a class="" href="https://www.thethingsnetwork.org/forum/c/network-and-routing/v3">Forum</a></p>
      </nav>
      
      <nav class="column is-one-quarter">
        <h3 class="title is-6">About Us</h3>
        <p><a class="" href="https://www.thethingsnetwork.org">The Things Network</a></p>
        <p><a class="" href="https://www.thethingsindustries.com">The Things Industries</a></p>
      </nav>
      <div class="column is-one-quarter">
        <h3 class="title is-6">About this page</h3>
        <div class="content">
<p class="is-size-7">
  Last changed by benolayinka on 08 Dec 2020.
  <br>
  <a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/commit/fc0b74d4e22584d10b5089573097a0629ba2711c">
      doc: Update missing notes
    </a>
</p>

<a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/blob/master/doc/content/getting-started/api/_index.md" class="button">Edit on Github</a>
</div>

      </div>
    </div>
  </div>
</footer>
<script src="https://www.thethingsindustries.com/docs/js/vendor/basicLightbox.min.js"></script>
<script src="https://www.thethingsindustries.com/docs/js/theme.min.e9df3c06e815b9686686212e86bfd0217a508f5ccee0139d7bc899ef7460191e.js" integrity="sha256-6d88BugVuWhmhiEuhr/QIXpQj1zO4BOde8iZ73RgGR4=" crossorigin="anonymous"></script>

</body>

</html>
